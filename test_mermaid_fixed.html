<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>修复后的Mermaid测试</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
        }
        .mermaid-container {
            width: 100%;
            margin: 20px 0;
            background: white;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            overflow: auto;
        }
        .mermaid-diagram {
            width: 100%;
            display: block;
            text-align: center;
            padding: 20px;
        }
        .mermaid-diagram svg {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        .test-result {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #28a745;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔧 修复后的Mermaid流程图测试</h1>
        
        <div class="mermaid-container">
            <div class="mermaid-diagram" id="mermaid-test">
                <!-- Mermaid图表将在这里渲染 -->
            </div>
        </div>
        
        <div class="test-result">
            <h3>📋 测试说明</h3>
            <p>这个测试使用修复后的Mermaid代码，应该能看到完整的流程：</p>
            <ul>
                <li>✅ Start (开始节点 - 蓝色)</li>
                <li>✅ smart_search (工具节点 - 绿色)</li>
                <li>✅ End (结束节点 - 蓝色)</li>
                <li>✅ 完整的箭头连接</li>
            </ul>
        </div>
    </div>

    <script>
        // 初始化Mermaid
        mermaid.initialize({
            startOnLoad: false,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });

        // 修复后的Mermaid代码
        const mermaidCode = `graph LR

    %% Node definitions
    Node1["smart_search"]

    %% Connections
    Start[Start] --> Node1
    Node1 --> End[End]

    %% Styles
    classDef default fill:#f9f9f9,stroke:#333,stroke-width:2px;
    classDef success fill:#d4edda,stroke:#155724,stroke-width:1px,color:#155724;
    classDef failure fill:#f8d7da,stroke:#721c24,stroke-width:1px,color:#721c24;
    classDef endpoint fill:#e0e7ff,stroke:#4f46e5,stroke-width:1px,color:#4f46e5;

    class Start,End endpoint;
    class Node1 success;`;

        // 渲染图表
        mermaid.render('mermaid-fixed-svg', mermaidCode).then(({ svg }) => {
            const element = document.getElementById('mermaid-test');
            element.innerHTML = svg;
            
            console.log('✅ Mermaid图表渲染成功！');
        }).catch(error => {
            console.error('❌ Mermaid渲染失败:', error);
            document.getElementById('mermaid-test').innerHTML = `<pre style="color: red; padding: 20px;">渲染失败: ${error.message}</pre>`;
        });
    </script>
</body>
</html> 