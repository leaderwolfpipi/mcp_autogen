# 百度搜索API配置指南

## 问题说明
由于Google搜索API在国内访问受限，我们已经将搜索工具切换为百度搜索API。百度搜索API在国内访问更稳定，配置也更简单。

## 完整配置流程

### 1. 申请百度开发者账号

1. **访问百度开发者中心**
   - 打开：https://developer.baidu.com/
   - 使用百度账户登录（如果没有百度账户，需要先注册）

2. **完成开发者认证**
   - 登录后，系统可能会要求完成开发者认证
   - 按照提示完成手机验证等步骤

### 2. 创建应用

1. **进入控制台**
   - 登录后，点击页面右上角的"控制台"

2. **创建新应用**
   - 点击"创建应用"
   - 填写应用信息：
     - **应用名称**：`MCP搜索工具`
     - **应用类型**：选择"服务端"
     - **应用描述**：`用于MCP项目的搜索工具`
   - 点击"创建"

3. **获取API密钥**
   - 创建完成后，在应用详情页面
   - 复制"API Key"（24位字符）
   - 复制"Secret Key"（32位字符）

### 3. 更新环境变量

编辑 `.env` 文件，添加百度API配置：

```bash
# 百度搜索API配置
BAIDU_API_KEY=your-baidu-api-key-here
BAIDU_SECRET_KEY=your-baidu-secret-key-here
```

### 4. 验证配置

运行配置助手进行验证：

```bash
python setup_baidu_api.py
```

## 搜索工具特性

### 搜索优先级
1. **百度搜索API** - 如果配置了API密钥和Secret密钥
2. **百度网页搜索** - 模拟百度网页搜索
3. **DuckDuckGo API** - 免费备用搜索
4. **模拟搜索** - 最后的备用方案

### 返回格式
```json
{
    "status": "success/error",
    "message": "执行消息",
    "results": [
        {
            "title": "结果标题",
            "link": "结果链接",
            "snippet": "结果摘要"
        }
    ],
    "source": "搜索源 (baidu_api/baidu_web/duckduckgo/mock)"
}
```

## 注意事项

### API配额限制
- 百度搜索API有免费配额限制
- 具体配额请查看百度开发者控制台
- 超出配额需要付费升级

### 安全建议
1. **保护API密钥**：不要将API密钥提交到版本控制
2. **限制访问**：在百度开发者控制台设置IP白名单
3. **定期轮换**：定期更新API密钥

### 备用方案
如果百度API配置失败，系统会自动使用：
1. 百度网页搜索（模拟）
2. DuckDuckGo API（免费，无需密钥）
3. 模拟搜索结果

## 故障排除

### 常见错误

1. **401 Unauthorized**
   - 检查API密钥和Secret密钥是否正确
   - 确认应用状态是否正常

2. **403 Forbidden**
   - 检查API配额是否用完
   - 确认IP是否在白名单中

3. **网络连接失败**
   - 检查网络连接
   - 尝试使用备用搜索方式

### 测试命令

```bash
# 测试百度搜索
python -c "
import os
from tools.search_tool import search_tool
result = search_tool('测试搜索')
print('搜索结果:', result)
"
```

## 配置完成后的效果

配置完成后，搜索工具将：
1. 优先使用百度搜索API
2. 提供中文搜索结果
3. 支持更复杂的搜索查询
4. 返回结构化的搜索结果
5. 在国内访问更稳定

如果百度API不可用，系统会自动降级到其他搜索方式，确保搜索功能始终可用。

## 与Google搜索的对比

| 特性 | 百度搜索 | Google搜索 |
|------|----------|------------|
| 国内访问 | ✅ 稳定 | ❌ 受限 |
| 中文结果 | ✅ 优秀 | ✅ 良好 |
| 配置难度 | ✅ 简单 | ❌ 复杂 |
| 免费配额 | ✅ 充足 | ❌ 有限 |
| 文档支持 | ✅ 中文 | ❌ 英文 |

## 迁移说明

如果您之前使用的是Google搜索，现在可以：

1. **保留Google配置**：Google配置仍然保留在代码中，但优先级降低
2. **使用百度搜索**：新的默认搜索方式
3. **自动降级**：如果百度搜索失败，会自动尝试其他方式

这样确保了系统的向后兼容性和稳定性。 